<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="PMS.dao.MainDao">
	<select id="getTitleByNo" resultType="string" parameterType="int">
		SELECT title
		FROM project
		WHERE pno = #{pno}
	</select>
	<select id="getScheduleList" resultType="schedule" parameterType="int">
		SELECT *
		FROM SCHEDULE
		WHERE pno = #{pno}
	</select>
	<select id="getSchedule" resultType="schedule" parameterType="int">
		SELECT *
		FROM SCHEDULE
		WHERE sno = #{sno}
	</select>
	<insert id="regSchedule" parameterType="schedule">
		INSERT INTO SCHEDULE
		values(seq_sno.nextval, #{pno}, #{sname}, #{status}, #{progress}, 
			to_date(#{startDate_s}, 'YYYY-MM-DD'), to_date(#{endDate_s}, 'YYYY-MM-DD'), #{budget})
	</insert>
	<update id="uptSchedule" parameterType="schedule">
		UPDATE SCHEDULE
		SET progress = #{progress}
		WHERE sno = #{sno}
	</update>
	<delete id="delSchedule" parameterType="int">
		DELETE
		FROM SCHEDULE
		WHERE sno = #{sno}
	</delete>
	<update id="uptScheduleByPM" parameterType="schedule">
		UPDATE SCHEDULE 
		SET sname = #{sname},
			status = #{status},
			progress = #{progress},
			startDate = to_date(#{startDate_s}, 'YYYY-MM-DD'),
			endDate = to_date(#{endDate_s}, 'YYYY-MM-DD'),
			budget = #{budget}
		WHERE sno = #{sno}
	</update>
	<select id="getPrjparticipant" resultType="account" parameterType="int">
		SELECT a.userno, pno, name, email, dept, position
		FROM PRJPARTICIPANT p, ACCOUNT a
		WHERE p.USERNO = a.USERNO 
		AND pno=#{pno}
	</select>
	
</mapper>


   